<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>++SD MANAGEMENT TERMINAL++</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

  body {
    background: black;
    color: white;
    font-family: 'Share Tech Mono', monospace;
    padding: 20px;
    user-select: none;
  }
  #terminal {
    white-space: pre-wrap;
    line-height: 1.3em;
    max-width: 800px;
    margin: auto;
  }
  .hidden {
    display: none;
  }
  .input-line {
    border-bottom: 1px solid white;
    margin: 8px 0;
    padding: 4px 8px;
  }
  button {
    background: none;
    border: 1px solid white;
    color: white;
    padding: 8px 16px;
    font-family: inherit;
    cursor: pointer;
    margin-top: 12px;
  }
  button:hover {
    background: white;
    color: black;
  }
  input[type="password"], input[type="text"] {
    background: black;
    border: 1px solid white;
    color: white;
    font-family: inherit;
    font-size: 1em;
    padding: 6px 10px;
    width: 100%;
    max-width: 300px;
  }
  .menu-option {
    cursor: pointer;
    color: #ccc;
  }
  .menu-option:hover {
    color: white;
    text-decoration: underline;
  }
  .passcode-dot {
    font-size: 1.2em;
    letter-spacing: 3px;
  }
  a {
    color: #66f;
  }
</style>
</head>
<body>

<div id="terminal"></div>

<script>
  // Data for agents and files
  const agents = {
    "RATCHET": "https://docs.google.com/document/d/19y8PjZXeLRLeM5YRb2OrC5P0a-y_LOkVk4Qapm9vlTI/edit",
    "CHINATSU": "https://docs.google.com/document/u/0/d/1_EHJ-ut4quezxCJSCrMR4vzMZpouqms10R9xtZA5tUY/mobilebasic",
    "AEGIS": "https://docs.google.com/document/d/1u4WypRconLkVQl2Kpyfo_-relGRMSm6kDn3RW5pOSqw/edit",
    "ULGRIN": "https://docs.google.com/document/d/1ihlLNXQDcQJWf-G8_ok3o8gZuD7j6ADwehyaVd29atw/edit",
    "BOBO": "https://docs.google.com/document/d/1Pe9M_jB5Ak95i-uoy9_3GvBNYkqAnEjyPIlboQxP7pE/edit",
    "CAELUM": "blocked", // restricted, needs passcode
    "BELL": "https://docs.google.com/document/d/1lhK-biGd6koGAMax01xtLYSweqGb8fm4fWI4RyZSdMM/edit",
    "EAGLE": "https://docs.google.com/document/d/1lhK-biGd6koGAMax01xtLYSweqGb8fm4fWI4RyZSdMM/edit" // example reuse Bell's link for Eagle
  };

  let terminal = document.getElementById("terminal");
  let lineIndex = 0;
  let currentStep = 0;
  let inputCallback = null;
  let passcode = "123456"; // passcode for blocked files (Caelum)
  let lastSelectedAgent = "";

  // Text lines for initial steps:
  const lines = [
    "++SD MANAGEMENT TERMINAL++",
    "———————————————————",
    "WARNING:",
    "YOU ARE ENTERING A RESTRICTED PROGRAM.",
    "",
    "PLEASE COMPLETE THE CAPTCHA GIVEN.",
    "…",
  ];

  const captchaComplete = [
    "CAPTCHA COMPLETED.",
    "",
    "PLEASE VERIFY AND ENTER YOUR CREDENTIALS.",
    "…",
    "STANDBY FOR VERIFICATION…",
    "…",
    "USER FOUND..",
    "CHECKING ACCESS LEVEL..",
    "…",
    "ACCESS LEVEL UP TO CODE",
    "VERIFYING…",
    "…",
    "AUTHORIZED. PROCEED.",
    "———————————————————",
    "WELCOME.",
    "",
    "SELECT CATEGORY",
    ">PERSONNEL",
    ">DATABASE",
    ">DIPLOMACY",
    ""
  ];

  const personnelList = [
    ">RATCHET",
    ">CHINATSU",
    ">AEGIS",
    ">ULGRIN",
    ">BOBO",
    ">CAELUM",
    ">BELL",
    ">EAGLE",
    ">NEXT PAGE.."
  ];

  function printLine(text, delay=50, callback=null) {
    // Simulate typing line with delay
    let i = 0;
    function typeChar() {
      if (i < text.length) {
        terminal.innerText += text[i];
        i++;
        setTimeout(typeChar, delay);
      } else {
        terminal.innerText += "\n";
        if (callback) callback();
      }
    }
    typeChar();
  }

  function printLines(arr, idx = 0, callback=null) {
    if (idx >= arr.length) {
      if(callback) callback();
      return;
    }
    printLine(arr[idx], 30, () => printLines(arr, idx+1, callback));
  }

  // Clear terminal
  function clearTerminal() {
    terminal.innerText = "";
  }

  // Display input prompt and accept user input
  function promptInput(promptText, callback, isPassword = false) {
    terminal.innerText += promptText;
    inputCallback = callback;
    let inputElement = document.createElement("input");
    inputElement.type = isPassword ? "password" : "text";
    inputElement.style.background = "black";
    inputElement.style.color = "white";
    inputElement.style.border = "1px solid white";
    inputElement.style.fontFamily = "'Share Tech Mono', monospace";
    inputElement.style.fontSize = "1em";
    inputElement.style.width = "300px";
    inputElement.autofocus = true;

    terminal.appendChild(inputElement);
    inputElement.focus();

    inputElement.addEventListener("keydown", e => {
      if (e.key === "Enter") {
        e.preventDefault();
        let val = inputElement.value.trim();
        terminal.removeChild(inputElement);
        terminal.innerText += val + "\n\n";
        inputCallback = null;
        callback(val);
      }
    });
  }

  function wait(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  // Main flow controller
  async function startTerminal() {
    clearTerminal();
    await printLines(lines);

    // Show CAPTCHA "button"
    const captchaBtn = document.createElement("button");
    captchaBtn.innerText = "Complete CAPTCHA";
    terminal.appendChild(captchaBtn);

    captchaBtn.onclick = async () => {
      captchaBtn.remove();
      terminal.innerText += "\n";
      await printLines(["…", "…", "…"]);
      await printLines(captchaComplete);

      showMainMenu();
    };
  }

  // Show main menu (PERSONNEL, DATABASE, DIPLOMACY)
  function showMainMenu() {
    promptInput("> ", (choice) => {
      const upperChoice = choice.toUpperCase();
      if (upperChoice === "PERSONNEL") {
        showPersonnelMenu();
      } else if (upperChoice === "DATABASE") {
        terminal.innerText += "DATABASE not implemented yet.\n\n";
        showMainMenu();
      } else if (upperChoice === "DIPLOMACY") {
        terminal.innerText += "DIPLOMACY not implemented yet.\n\n";
        showMainMenu();
      } else {
        terminal.innerText += "INVALID OPTION. TRY AGAIN.\n\n";
        showMainMenu();
      }
    });
  }

  // Show Personnel Menu
  function showPersonnelMenu() {
    clearTerminal();
    terminal.innerText += "PERSONNEL SELECTED\n\nPLEASE SELECT FILE\n";
    personnelList.forEach(p => terminal.innerText += p + "\n");
    terminal.innerText += "\n";

    promptInput("> ", (selection) => {
      const sel = selection.toUpperCase();
      if (sel === "NEXT PAGE.." || sel === "NEXT PAGE") {
        terminal.innerText += "\nNO MORE PAGES AVAILABLE.\n\n";
        showPersonnelMenu();
        return;
      }
      if (agents.hasOwnProperty(sel)) {
        lastSelectedAgent = sel;
        if (agents[sel] === "blocked") {
          // Restricted file: ask for passcode
          terminal.innerText += "\nERROR: FILE BLOCKED\n\nPLEASE ENTER PASSCODE\n";
          promptInput("> ", (pass) => {
            if (pass === passcode) {
              terminal.innerText += "\nPASSCODE VERIFIED\nACCESS GRANTED\n\n";
              showAgentFile(sel);
            } else {
              terminal.innerText += "\nPASSCODE DENIED\nACCESS DENIED\n\n";
              showPersonnelMenu();
            }
          }, true);
        } else {
          // Open file directly
          showAgentFile(sel);
        }
      } else {
        terminal.innerText += "\nINVALID SELECTION. TRY AGAIN.\n\n";
        showPersonnelMenu();
      }
    });
  }

  // Show agent file link or content
  function showAgentFile(agent) {
    clearTerminal();
    terminal.innerText += `--- ${agent} FILE ---\n\n`;
    const link = agents[agent];
    if (link === "blocked") {
      terminal.innerText += "[ERROR: FILE STILL BLOCKED]\n\n";
      showPersonnelMenu();
      return;
    }
    terminal.innerHTML += `Document link: <a href="${link}" target="_blank">${link}</a>\n\n`;
    terminal.innerText += "Press ENTER to return to PERSONNEL MENU.\n\n";

    promptInput("> ", () => {
      showPersonnelMenu();
    });
  }

  // Start terminal on load
  window.onload = startTerminal;
</script>

</body>
</html>
